<!DOCTYPE html>
<html lang="ja">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Voice AI Assistant</title>
    <link rel="stylesheet" href="index.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
  <script type="importmap">
{
  "imports": {
    "@google/genai": "https://esm.sh/@google/genai@^1.12.0"
  }
}
</script>
<link rel="stylesheet" href="/index.css">
</head>
<body>
    <div id="root">
        <div class="api-key-container">
            <div class="api-key-box">
                <h1>AI Assistant Setup</h1>
                <p>Please provide your Google Gemini API key to start the session.</p>
                <input
                    id="api-key-input"
                    type="password"
                    placeholder="Enter your API Key"
                    class="api-key-input"
                />
                <button id="api-key-button" class="api-key-button">
                    Start Session
                </button>
                <p id="api-key-error" class="api-key-error"></p>
                <p class="api-key-disclaimer">
                    Your API key is stored locally in your browser and is not sent anywhere else.
                </p>
            </div>
        </div>

        <div class="app-container" style="display: none;">
             <div class="camera-container">
                <div class="top-left-controls">
                    <button id="save-conversation-button" class="control-button" aria-label="Save Conversation" title="Save Conversation" disabled>
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                    </button>
                    <button id="save-analysis-button" class="control-button" aria-label="Save Analysis Log" title="Save Analysis Log" disabled>
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8l-6-6zm2 14H8v-2h8v2zm0-4H8v-2h8v2zm-3-5V3.5L18.5 9H13z"/></svg>
                    </button>
                    <button id="reset-button" class="control-button" aria-label="Reset Session" title="Reset Session" disabled>
                        <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 5V1L7 6l5 5V7c3.31 0 6 2.69 6 6s-2.69 6-6 6-6-2.69-6-6H4c0 4.42 3.58 8 8 8s8-3.58 8-8-3.58-8-8-8z"/></svg>
                    </button>
                </div>
                <video id="video-feed" autoplay playsinline muted class="camera-feed"></video>
                <div id="camera-off-placeholder" class="camera-off-placeholder">
                    <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9.4 10.5h5.2v5H9.4v-5zm-2.4 5c0 .55.45 1 1 1h5.2c.55 0 1-.45 1-1v-5c0-.55-.45-1-1-1H8c-.55 0-1 .45-1 1v5zm8-7.5L12.95 6H9.05L7 8H4c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1h16c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1h-3z"/></svg>
                    <p>Camera is off</p>
                </div>
                <div class="top-right-controls">
                    <button id="switch-camera-button" class="control-button" aria-label="Switch Camera" title="Switch Camera" disabled>
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 5h-3.17L15 3H9L7.17 5H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm-5 13.5V17H9v1.5H7.5V17H6v-5h1.5V10H9V8.5h6V10h1.5v2H18v5h-1.5v1.5h-1.5zM15 12c0-1.66-1.34-3-3-3s-3 1.34-3 3 1.34 3 3 3 3-1.34 3-3z"/>
                        </svg>
                    </button>
                </div>
                <div id="analysis-overlay" class="analysis-overlay" style="display: none;">
                    <p id="analysis-result"></p>
                </div>
                <div class="controls-container">
                     <div class="button-row">
                        <button id="camera-toggle-button" class="camera-toggle-button off" aria-label="Toggle Camera">
                            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M9.4 10.5h5.2v5H9.4v-5zm-2.4 5c0 .55.45 1 1 1h5.2c.55 0 1-.45 1-1v-5c0-.55-.45-1-1-1H8c-.55 0-1 .45-1 1v5zm8-7.5L12.95 6H9.05L7 8H4c-.55 0-1 .45-1 1v8c0 .55.45 1 1 1h16c.55 0 1-.45 1-1V9c0-.55-.45-1-1-1h-3z"/></svg>
                        </button>
                        <button id="status-indicator" class="status-indicator idle" aria-label="タップして話す">
                            <!-- Icon will be inserted by JS -->
                        </button>
                        <button id="analysis-toggle-button" class="analysis-toggle-button" aria-label="Toggle Live Analysis">
                            <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5C21.27 7.61 17 4.5 12 4.5zm0 12c-2.48 0-4.5-2.02-4.5-4.5S9.52 7.5 12 7.5s4.5 2.02 4.5 4.5-2.02 4.5-4.5 4.5zm0-7c-1.38 0-2.5 1.12-2.5 2.5s1.12 2.5 2.5 2.5 2.5-1.12 2.5-2.5-1.12-2.5-2.5-2.5z"/></svg>
                        </button>
                     </div>
                    <p id="status-text" class="status-text">タップして話す</p>
                </div>
            </div>
            <div id="conversation-log" class="conversation-log">
                <div class="welcome-message">
                    <h1>Voice AI Assistant</h1>
                    <p>Tap the button below and start speaking.</p>
                </div>
            </div>
            <div id="error-message" class="error-message" style="display: none;"></div>
        </div>
    </div>
    <script type="module" src="index.js"></script>
  <script type="module" src="/index.tsx"></script>
</body>
</html>
